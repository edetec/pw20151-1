<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:m="http://code.google.com/p/gmaps4jsf/">

<ui:composition template="/WEB-INF/templates/padrao.xhtml">
	<ui:define name="content">
		<script type="text/javascript"
			src="https://maps.googleapis.com/maps/api/js?sensor=true">
    </script>
		<h:form id="form">
			<m:map width="400px" height="400px"
				jsVariable="map1" zoom="14" address="Florianopolis, BR">
				<m:marker address="Florianopolis, BR" jsVariable="marker1"
					draggable="true">
					<m:eventListener eventName="dragend"
						jsFunction="marker1DragHandler" />
				</m:marker>
			</m:map>
			
			<h:inputHidden id="idLat" value="#{enderecoMB.latitude}" />
			<h:inputHidden id="idLon" value="#{enderecoMB.longitude}" />
			<h:commandButton value="Save as a favorite place!!!"
				action="#{enderecoMB.save()}" />
			<br />
			<h:outputText
				value="First place (lat, lng): (#{enderecoMB.latitude}, #{enderecoMB.longitude})" />
			<br />
			<script type="text/javascript">
               function marker1DragHandler(event) {
            	   document.getElementById('form:idLat').value = event.latLng.A;
            	   document.getElementById('form:idLon').value = event.latLng.F;
                   
            	   alert("Current marker1 latlng is: " +  document.getElementById('form:idLon').value);
               }
            </script>
		</h:form>
	</ui:define>
</ui:composition>
</html>